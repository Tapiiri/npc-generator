{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "NPC Data Schema",
    "type": "array",
    "items": {
        "type": "object",
        "properties": {
          "metadata": {
            "type": "object",
            "properties": {
              "version": { "type": "string", "default": "1.0" },
              "author": { "type": "string" },
              "created_at": { "type": "string", "format": "date-time" },
              "notes": { "type": "string" }
            },
            "additionalProperties": true
          },
          "attributes": {
            "type": "object",
            "properties": {
              "name": { "type": "string" },
              "role": { "type": "string" },
              "appearance": { "type": "string" },
              "race": { "type": "string" },
              "class": { "type": "string" },
              "age": { "type": ["string", "number"] },
              "personality": { "type": "string" },
              "quirks": { "type": "string" },
              "alignment": { "type": "string" },
              "background": { "type": "string" },
              "additional_info": {
                "type": "object",
                "additionalProperties": { "type": ["string", "number", "object", "array"] }
              },
              "portrait": { "type": "string", "format": "uri" } 
            },
            "required": ["name"],
            "additionalProperties": true
          },
          "stat_blocks": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "title": { "type": "string" },
                "abilities": {
                  "type": "object",
                  "properties": {
                    "strength": { "type": "number" },
                    "dexterity": { "type": "number" },
                    "constitution": { "type": "number" },
                    "intelligence": { "type": "number" },
                    "wisdom": { "type": "number" },
                    "charisma": { "type": "number" }
                  },
                  "additionalProperties": true
                },
                "armor_class": { "type": ["number", "string"] },
                "hit_points": { "type": ["number", "string"] },
                "speed": { "type": "string" },
                "skills": {
                  "type": "array",
                  "items": { "type": "string" }
                },
                "senses": { "type": "string" },
                "languages": { 
                    "type": "array",
                    "items": {
                        "type": "string"
                    } 
                },
                "challenge_rating": { "type": ["number", "string"] },
                "special_abilities": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "name": { "type": "string" },
                      "description": { "type": "string" },
                      "metadata": { "type": "object", "additionalProperties": true }
                    },
                    "required": ["name", "description"],
                    "additionalProperties": true
                  }
                }
              },
              "additionalProperties": true
            }
          },
          "custom_fields": {
            "type": "object",
            "additionalProperties": true
          },
          "icons": {
            "type": "object",
            "additionalProperties": {
              "type": "string",
              "format": "uri"
            }
          },
          "template_instructions": {
            "type": "object",
            "properties": {
              "layout": { "type": "string" },
              "sections": {
                "type": "array",
                "items": { "type": "string" }
              },
              "field_formatting": {
                "type": "object",
                "additionalProperties": {
                  "type": "object",
                  "properties": {
                    "display_name": { "type": "string" },
                    "format": { "type": "string" },
                    "location": { "type": "string" }
                  },
                  "additionalProperties": true
                }
              }
            },
            "additionalProperties": true
          }
        },
        "required": ["attributes"],
        "additionalProperties": true
      }
    }
  